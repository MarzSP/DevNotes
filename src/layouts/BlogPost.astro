---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Header from '../components/Header.astro';

const { title, description, pubDate, updatedDate, heroImage, fullWidth = false } = Astro.props;
---

<html lang="en">
	<head>
		<BaseHead title={title} description={description} />
		<title>{title}</title>
		<style>
			main {
				width: calc(100% - 2em);
				max-width: 100%;
				margin: 0;
			}
			.hero-image {
				width: 50%;
				margin: 0 auto;
				display: flex;
				justify-content: center;
			}
			.hero-image img {
				width: 100%;
				max-width: 510px;
				height: auto;
				display: block;
				margin: 0 auto;
				border-radius: 12px;
				box-shadow: var(--box-shadow);
			}
			.prose {
				width: 720px;
				max-width: calc(100% - 2em);
				margin: auto;
				padding: 1em;
				color: rgb(var(--gray-dark));
			}
			/* Full width variant used by pages like Foundations */
			.prose--wide {
				width: calc(100% - 2em);
				max-width: 100%;
				margin: 0;
				padding: 1em;
			}
			.title {
				margin-bottom: 1em;
				padding: 1em 0;
				text-align: center;
				line-height: 1;
			}
			.title h1 {
				margin: 0 0 0.5em 0;
			}
			.date {
				margin-bottom: 0.5em;
				color: rgb(var(--gray));
			}
			.last-updated-on {
				font-style: italic;
			}

			/* Foundations grid: responsive two-column when space allows */
			:global(.foundations-grid) {
				display: grid;
				gap: 1.5rem;
				grid-template-columns: 1fr;
				max-width: 1200px;
				margin: 0 auto;
				padding-left: 1rem;
				padding-right: 1rem;
			}

			@media (min-width: 640px) {
				:global(.foundations-grid) {
					grid-template-columns: repeat(2, minmax(0, 1fr));
					align-items: start;
				}
			}
			@media (min-width: 1024px) {
				:global(.foundations-grid) {
					grid-template-columns: repeat(3, minmax(0, 1fr));
					max-width: 1700px;
				}
			}
			:global(.foundations-box) {
				background: rgb(var(--card-bg, 255 255 255));
				border-radius: 8px;
				padding: 1.25rem;
				box-shadow: var(--box-shadow);
				border: 1px solid rgba(0,0,0,0.06);
				display: block;
				color: inherit;
				text-decoration: none;
				transition: transform 120ms ease, box-shadow 120ms ease, border-color 120ms ease, background 120ms ease;
			}

			:global(.foundations-box h2) { margin: 0 0 0.5rem 0; }
			:global(.foundations-box p) { margin: 0; }
			:global(.foundations-box) {
				color: rgba(255, 255, 255, 0.82);
			}

			:global(.foundations-box h2) {
				color: rgba(255, 255, 255, 0.95);
			}

			:global(.foundations-box p) {
				margin: 0 0 0.75rem 0;
				color: rgba(255, 255, 255, 0.85);
				font-size: 0.99rem;
			}

			:global(.foundations-box ul) {
				margin-top: 0.9rem;
				padding-left: 1.2rem;
			}

			:global(.foundations-box li) {
				margin: 0.55rem 0;
				line-height: 1.45;
				color: rgba(255, 255, 255, 0.80);
				font-size: 1rem;
			}

			:global(.foundations-box li::marker) {
				color: rgba(255, 255, 255, 0.35);
			}

			:global(.foundations-box a) {
				display: inline-flex;
				flex-direction: column;
				gap: 0.15rem;
				color: rgba(120, 190, 255, 0.9);
				text-decoration: none;
			}

			:global(.foundations-box .link-label) {
				font-size: 1rem;
			}

			:global(.foundations-box .link-url) {
				font-size: 0.75rem;
				color: rgba(255, 255, 255, 0.45);
				font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
			}

			:global(.foundations-box a:hover .link-url) {
				color: rgba(255, 255, 255, 0.65);
			}

			:global(.foundations-box a:hover) {
				text-decoration: underline;
			}

			:global(.foundations-box .muted) {
				color: rgba(255, 255, 255, 0.62);
			}


			:global(.foundations-box--websites) {
				background: linear-gradient(180deg, rgba(6,95,70,0.10), rgba(6,95,70,0.03));
				border: 1px solid rgba(6,95,70,0.25);
			}

			:global(.foundations-box--books) {
				background: linear-gradient(180deg, rgba(88,35,139,0.10), rgba(88,35,139,0.03));
				border: 1px solid rgba(88,35,139,0.25);
			}
			:global(.foundations-box--podcasts) {
				background: linear-gradient(180deg, rgba(2,132,199,0.10), rgba(2,132,199,0.03));
				border: 1px solid rgba(2,132,199,0.25);
			}

		</style>
	</head>

	<body>
		<Header />
		<main>
			<article>
				<div class="hero-image">
					{heroImage && <Image width={1020} height={510} src={heroImage} alt="" />}
				</div>
				<div class={fullWidth ? 'prose prose--wide' : 'prose'}>
					<div class="title">
						<div class="date">
							<FormattedDate date={pubDate} />
							{
								updatedDate && (
									<div class="last-updated-on">
										Last updated on <FormattedDate date={updatedDate} />
									</div>
								)
							}
						</div>
						<h1>{title}</h1>
						<hr />
					</div>
					<slot />
				</div>
			</article>
		</main>
		<Footer />
		</body>
</html>
